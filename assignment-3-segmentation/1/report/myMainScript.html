
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>myMainScript</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-10-16"><meta name="DC.source" content="myMainScript.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Q1</a></li><li><a href="#2">Q1a</a></li><li><a href="#6">Q1b</a></li><li><a href="#9">Q1c</a></li><li><a href="#11">Q1d</a></li></ul></div><h2 id="1">Q1</h2><p>References:</p><p>1) We used nlfilter from the matlab standard documentation.</p><p>2) We used the class slides for the definition of structure tensor. The formulae for the eigenvalues could easily be derived from there.</p><h2 id="2">Q1a</h2><p>For the gaussian blurring, we use a 9*9 sliding window with a variance of 0.6.</p><img vspace="5" hspace="5" src="myMainScript_01.png" alt=""> <img vspace="5" hspace="5" src="myMainScript_02.png" alt=""> <h2 id="6">Q1b</h2><img vspace="5" hspace="5" src="myMainScript_03.png" alt=""> <img vspace="5" hspace="5" src="myMainScript_04.png" alt=""> <p>(We also plot the gradient as a sanity check)</p><img vspace="5" hspace="5" src="myMainScript_05.png" alt=""> <h2 id="9">Q1c</h2><p>We note that the principal eigenvalue is large whenever there is an edge or corner, which clearly seems to match the theoretical expectations.</p><img vspace="5" hspace="5" src="myMainScript_06.png" alt=""> <p>The secondary eigenvalue is only large when a corner is present.</p><img vspace="5" hspace="5" src="myMainScript_07.png" alt=""> <h2 id="11">Q1d</h2><p>In the computation of the structure tensor, we use a 9*9 gaussian with a 0.6 variance. The free parameter k = 0.03, which is chosen such that the points which are neither edges nor corners have cornerness values close to zero and the points which are edges and not corners have negative cornerness values.</p><img vspace="5" hspace="5" src="myMainScript_08.png" alt=""> <p>We superimpose the cornerness measure after thresholding with the original image to see the corners. The threshold value is chosen as 2e-5. The white points denote corners.</p><img vspace="5" hspace="5" src="myMainScript_09.png" alt=""> <pre class="codeoutput">Elapsed time is 18.707299 seconds.
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Q1
% References:
%
% 1) We used nlfilter from the matlab standard documentation. 
%
% 2) We used the class slides for the definition of structure tensor. The
% formulae for the eigenvalues could easily be derived from there.
myNumOfColors = 200;
myColorScale = [ [0:1/(myNumOfColors-1):1]' , ...
    [0:1/(myNumOfColors-1):1]' , [0:1/(myNumOfColors-1):1]' ];
tic;
%% Q1a
% For the gaussian blurring, we use a 9*9 sliding window with a variance of
% 0.6.
boat_im = load('../data/boat.mat');
boat_im = double(cell2mat(struct2cell(boat_im)));

boat_im = boat_im - min(min(boat_im));
boat_im = boat_im / (1.0 * max(max(boat_im)));

boat_im_blur = nlfilter(boat_im, [9,9], @(x) myGaussianBlurring(x, 9, 0.6));
%%
subplot(1,1,1), imagesc(boat_im);
daspect ([1 1 1]);
title('Original Image');
colorbar;
colormap (myColorScale);
colormap gray;
%%
subplot(1,1,1), imagesc(boat_im_blur);
daspect ([1 1 1]);
title('Blurred Image');
colorbar;
colormap (myColorScale);
colormap gray;
%%
[partialX, partialY, grad_im, eigen_prim, eigen_second, cornerness_im] = myHarrisCornerDetector(boat_im_blur, 9, 0.6, 0.03);
%% Q1b
subplot(1,1,1), imagesc(partialX);
daspect ([1 1 1]);
title('Partial Derivative along X axis');
colorbar;
colormap (myColorScale);
colormap gray;
%%
subplot(1,1,1), imagesc(partialY);
daspect ([1 1 1]);
title('Partial Derivative along Y axis');
colorbar;
colormap (myColorScale);
colormap gray;
%%
% (We also plot the gradient as a sanity check)
subplot(1,1,1), imagesc(grad_im);
daspect ([1 1 1]);
title('Gradient Plot');
colorbar;
colormap (myColorScale);
colormap gray;
%% Q1c
% We note that the principal eigenvalue is large whenever there is an edge
% or corner, which clearly seems to match the theoretical expectations.
subplot(1,1,1), imagesc(eigen_prim);
daspect ([1 1 1]);
title('Principal Eigenvalue of Structure Tensor');
colorbar;
colormap (myColorScale);
colormap gray;
%%
% The secondary eigenvalue is only large when a corner is present.
subplot(1,1,1), imagesc(eigen_second);
daspect ([1 1 1]);
title('Other Eigenvalue of Structure Tensor');
colorbar;
colormap (myColorScale);
colormap gray;
%% Q1d
% In the computation of the structure tensor, we use a 9*9 gaussian with a
% 0.6 variance. The free parameter k = 0.03, which is chosen such that the
% points which are neither edges nor corners have cornerness values close
% to zero and the points which are edges and not corners have negative
% cornerness values.

subplot(1,1,1), imagesc(cornerness_im);
daspect([1 1 1]);
title('Harris Cornerness Measure');
colorbar;
colormap (myColorScale);
colormap gray;

%% 
% We superimpose the cornerness measure after thresholding with the
% original image to see the corners. The threshold value is chosen as
% 2e-5. The white points denote corners.

new_cornerness = cornerness_im > 0.000020;
new_cornerness = new_cornerness - min(min(new_cornerness));
new_cornerness = new_cornerness / max(max(new_cornerness));
new_cornerness = new_cornerness + boat_im_blur;
new_cornerness = new_cornerness - min(min(new_cornerness));
new_cornerness = new_cornerness / max(max(new_cornerness));
subplot(1,1,1), imagesc(new_cornerness);
daspect ([1 1 1]);
title('Superimposed image');
colorbar;
colormap (myColorScale);
colormap gray;
%%
toc;
##### SOURCE END #####
--></body></html>